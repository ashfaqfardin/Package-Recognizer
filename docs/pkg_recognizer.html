---
title: Packaging Recognizer
layout: page
---

<style>
  .spinner {
    width: 32px;
    height: 32px;
    border: 4px solid rgba(0,0,0,0.1);
    border-left-color: #4a90e2;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    display: inline-block;
    vertical-align: middle;
    margin-right: 8px;
  }
  @keyframes spin { to { transform: rotate(360deg); } }
  #status { font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; color: #333; }
</style>

<label for="photo">Upload an image to classify:</label>
<input id="photo" type="file" accept="image/*">
<div id="status" aria-live="polite"></div>
<div id="results"></div>

<script type="module">
  import { Client, handle_file } from "https://esm.sh/@gradio/client";

  const input = document.getElementById("photo");
  const results = document.getElementById("results");
  const status = document.getElementById("status");

  input.addEventListener("change", async () => {
    if (!input.files || input.files.length === 0) return;
    const file = input.files[0];

    // UI: show loading, disable input
    input.disabled = true;
    results.innerHTML = "";
    status.innerHTML = `<span class="spinner" aria-hidden="true"></span>Uploading & processing...`;

    try {
      const client = await Client.connect("ashfaqfardin/pkg_recognizer");

      const payload = { image: handle_file(file) };
      const result = await client.predict("/predict", payload);

      let label = "";
      if (Array.isArray(result?.data) && result.data.length > 0) {
        const first = result.data[0];
        if (first && typeof first === 'object' && 'label' in first) {
          label = first.label;
        } else {
          label = String(first);
        }
      } else {
        label = "(no prediction)";
      }

      const imgURL = URL.createObjectURL(file);
      results.innerHTML = `\n        <figure>
          <img src="${imgURL}" alt="Uploaded image" style="max-width:100%;height:auto;"/>
          <figcaption style="font-weight:600;margin-top:.5rem">Prediction: ${label}</figcaption>
        </figure>`;
      status.textContent = "Done.";
    } catch (err) {
      console.error(err);
      status.textContent = `Error: ${err?.message ?? err}`;
    } finally {
      input.disabled = false;
    }
  });
</script>